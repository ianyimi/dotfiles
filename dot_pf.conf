# === PF Options ===
set skip on lo0  # Don't filter localhost traffic

# === Normalization ===
scrub in all

# === Queueing (not used) ===

# === Translation (includes anchors, NAT, rdr) ===
scrub-anchor "com.apple/*"
nat-anchor "com.apple/*"
rdr-anchor "com.apple/*"
dummynet-anchor "com.apple/*"
anchor "com.apple/*"
load anchor "com.apple" from "/etc/pf.anchors/com.apple"

# === Filtering Rules ===

# Allow all outgoing connections
pass out all keep state

# Allow incoming connections on port 3000 from Tailscale subnet
pass in proto tcp from 100.64.0.0/10 to any port 3000 keep state

# Block everything else
block in all
